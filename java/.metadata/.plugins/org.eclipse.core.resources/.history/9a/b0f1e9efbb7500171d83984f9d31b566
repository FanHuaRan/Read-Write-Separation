package com.fhr.readwritedemo.core.services.impl;

import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.apache.commons.lang3.StringUtils;

import com.fhr.readwritedemo.core.services.IPageQueryCreateStrategy;

public class MSSqlPageQueryCreateStrategy implements IPageQueryCreateStrategy{

	@Override
	public String createSimpleQuery(String tableName, int pageIndex, int count,List<String> ascFields,List<String> descFields) {
		int fromIndex=pageIndex*count;
		int toIndex=fromIndex+count;
		StringBuilder builder=new StringBuilder(String.format("select * from %s ",tableName));
		//Stream<String> sortStrs=new ArrayList<>();
		String ascStr="",descStr="";
		if(ascFields!=null&&!ascFields.isEmpty()){
			//ascStrs=ascFields.stream().map(p->String.format("%s asc", p)).collect(Collectors.joining(","," "," "));
		}
		if(descFields!=null&&!descFields.isEmpty()){
			descStr=ascFields.stream().map(p->String.format("%s desc", p)).collect(Collectors.joining(","," "," "));
		}
		if(StringUtils.isNotEmpty(ascStr)||StringUtils.isNotEmpty(descStr)){
			builder.append(" order by ");
		}
		return null;
	}
	
	
	
	
}
