package com.fhr.osmonitor.components;

import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.SocketException;

import com.fhr.osmonitor.dtos.OSystemMonitorInfo;
import com.fhr.osmonitor.models.OSystemInfo;

public class OsMonitUDPServer {
	
	private final OsMonitor osMonitor;
	
	private final DatagramSocket datagramSocket;
	
	public OsMonitUDPServer(OsMonitor osMonitor) throws SocketException{
		this.osMonitor=osMonitor;
		this.datagramSocket=new DatagramSocket(MonitorConfig.MONIT_SOCKET_PORT);
	}
	
	public void init(){
		//nothing
	}
	
	public void start(){
		while(true){
			try{
	            byte[] receiveBytes = new byte[1024];
				DatagramPacket reveivePacket=new DatagramPacket(receiveBytes,receiveBytes.length);
				datagramSocket.receive(reveivePacket);
				///////reveivePacket.getLength()>0
				InetAddress address=reveivePacket.getAddress();
				
				DatagramPacket sendDataPacket=new DatagramPacket(buf, length, address, port);
				datagramSocket.send(p);
			}catch(Exception e){
				
			}
		}
	}
	
	//private byte[] getSystemMoni
	
	private OSystemMonitorInfo getOSystemMonitorInfo(){
		OSystemInfo oSystemInfo=osMonitor.getOSystemInfo();
		return new OSystemMonitorInfo(oSystemInfo.getMemoryRatio(),oSystemInfo.getCpuRatio(),oSystemInfo.getMonitTime());
	}
}
